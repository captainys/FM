#include <stdio.h>
#include <stdlib.h>



// EXP file size in the directory.  
// 574156 ->574412
unsigned char fileSize_from[]=
{
	0xcc,0xc2,0x08,0x00,0x00,0x08,0xc2,0xcc
};
unsigned char fileSize_to[]=
{
	0xcc,0xc3,0x08,0x00,0x00,0x08,0xc3,0xcc
};


// EXP Headers of KTIGER.EXP
unsigned char expSize_from[]=
{
	0x4D,0x50,0xCC,0x00,0x62,0x04,0x00,0x00,0x20,0x00
};
unsigned char expSize_to[]=
{
	0x4D,0x50,0xCC,0x01,0x62,0x04,0x00,0x00,0x20,0x00
};


unsigned char uncompressor_size_from[]=
{
	0xBE,0xCB,0xC0,0x08,0x00,               // MOV     ESI,0008C0CBH   -> 0008C1CB
	0xB9,0xC2,0x00,0x00,0x00                // MOV     ECX,000000C2H   -> 000001C2
};

unsigned char uncompressor_size_to[]=
{
	0xBE,0xCB,0xC1,0x08,0x00,               // MOV     ESI,0008C0CBH   -> 0008C1CB
	0xB9,0xC2,0x01,0x00,0x00                // MOV     ECX,000000C2H   -> 000001C2
};


// If CMOS is clear due to battery depretion, or corrupted, T_OAK2.EXE, which is not used
// by Kyukyoku Tiger, will fail, and Kyukyoku Tiger fails to start.  Which is rediculous.
// This patch will by-pass the error check after T_OAK2.EXE so that the game can start
// regardless of the state of CMOS RAM.
unsigned char ignore_T_OAK2_error_from[]=
{
0x72,0x11,0xb4,0x4d,0xcd,0x21,0x0a,0xc0,0x74,0x03,0xe9,0x30,0x02
};

unsigned char ignore_T_OAK2_error_to[]=
{
0x72,0x11,0xb4,0x4d,0xcd,0x21,0x0a,0xc0,0xEB,0x03,0xe9,0x30,0x02
};


// Force CD BIOS
unsigned char forceCDBIOS_pattern[]=
{
	0x68,0x9C,0xA9,0x14,0x00,  // PUSH    DWORD PTR 0014A99CH
	0xC3                       // RET
};

unsigned char forceCDBIOS_patch[]=
{
	0xe8,0x00,0x00,0x00,0x00,0x5e,0x83,0xc6,
	0x11,0xbf,0x32,0x0a,0x15,0x00,0xb9,0x9a,
	0x00,0x00,0x00,0xf3,0xa4,0xc3,0x53,0x0a,
	0x15,0x00,0x53,0x0a,0x15,0x00,0x53,0x0a,
	0x15,0x00,0x53,0x0a,0x15,0x00,0x53,0x0a,
	0x15,0x00,0x4a,0x0a,0x15,0x00,0xb4,0x55,
	0xb0,0xc0,0x31,0xc9,0xcd,0x93,0xc3,0x06,
	0xa2,0x74,0x1a,0x00,0x00,0x83,0xec,0x14,
	0x0f,0xb6,0xc8,0x8d,0x04,0x49,0x8d,0xb4,
	0x00,0xf0,0x19,0x00,0x00,0x66,0xbb,0x01,
	0x00,0x66,0xb8,0xc0,0x25,0xcd,0x21,0x72,
	0x52,0x66,0xc7,0x04,0x24,0x93,0x00,0x66,
	0x89,0x44,0x24,0x02,0x66,0xc7,0x44,0x24,
	0x0a,0xc0,0x50,0xb1,0x60,0x8e,0xc1,0x0f,
	0xb7,0xf8,0xc1,0xe7,0x04,0xc1,0xe9,0x04,
	0xac,0x88,0xc3,0xc0,0xe8,0x04,0xb4,0x0a,
	0xf6,0xe4,0x80,0xe3,0x0f,0x00,0xd8,0xaa,
	0xe2,0xee,0x66,0xb8,0xc0,0x52,0xcd,0x93,
	0x31,0xff,0x89,0xe2,0x66,0xb9,0x01,0x00,
	0x66,0xb8,0x11,0x25,0xcd,0x21,0x66,0x8b,
	0x4c,0x24,0x02,0x50,0x66,0xb8,0xc1,0x25,
	0xcd,0x21,0x58,0x83,0xc4,0x14,0x07,0xc3
};



int ApplyPatch(
    int nByte,unsigned char byteData[],
    int nPatchFrom,const unsigned char patchFrom[],
    int nPatchTo,const unsigned char patchTo[])
{
	int nOccurrence=0;
	for(int i=0; i+nPatchFrom<=nByte; ++i)
	{
		int found=1;
		for(int j=0; j<nPatchFrom && i+j<nByte; ++j)
		{
			if(byteData[i+j]!=patchFrom[j])
			{
				found=0;
				break;
			}
		}
		if(0!=found)
		{
			printf("Apply Patch at %08x\n",i);
			for(int j=0; j<nPatchTo; ++j)
			{
				byteData[i+j]=patchTo[j];
			}
			++nOccurrence;
		}
	}
	return nOccurrence;
}

int ApplyPatchExternal(
    size_t nByte,unsigned char byteData[],
    size_t nPatchSig,const unsigned char patchSig[],
    size_t offset_from_signature,
    size_t patchSize,const unsigned char patchData[])
{
	size_t foundOffset=~0;
	for(size_t i=0; i+nPatchSig<nByte; ++i)
	{
		if(0==memcmp(byteData+i,patchSig,nPatchSig))
		{
			foundOffset=i;
			break;
		}
	}

	if(~0==foundOffset)
	{
		return 0;
	}

	unsigned char *loadPoint=byteData+foundOffset+offset_from_signature;

	if(nByte<foundOffset+offset_from_signature+patchSize)
	{
		fprintf(stderr,"Patch does not fit.\n");
		return 0;
	}

	memcpy(loadPoint,patchData,patchSize);

	printf("Applied to offset %llu\n",foundOffset+offset_from_signature);

	return 1;
}


// Boot Sector that enables dual boot.  Can be boot from SCSI CD, or Internal CD directly, without the Rescue IPL.
// (Or, in other words, the Rescue IPL all in the first 4 sectors of the CD-ROM).
const unsigned char BOOTSECT[5623]=
{
	0x49,0x50,0x4c,0x34,0xeb,0x22,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x00,
	0xfa,0xfc,0x0e,0x1f,0x53,0xe8,0xfd,0x11,
	0xe8,0x03,0x13,0xe8,0x04,0x12,0xe8,0x45,
	0x15,0xe8,0xd7,0x12,0xe8,0x48,0x15,0x5b,
	0x80,0xfb,0x01,0x0f,0x84,0xa9,0x00,0x80,
	0xfb,0x08,0x0f,0x84,0x01,0x00,0xcb,0xbf,
	0x01,0x05,0xbe,0x75,0x0f,0xe8,0x64,0x12,
	0x2e,0x66,0x8b,0x16,0x20,0x00,0xe8,0x55,
	0x00,0x0f,0x83,0x13,0x00,0xba,0x08,0x00,
	0xe8,0x4b,0x00,0x0f,0x83,0x09,0x00,0x42,
	0x83,0xfa,0x50,0x75,0xf3,0xe9,0xc0,0x00,
	0x1e,0xb8,0x40,0x00,0x8e,0xd8,0x33,0xff,
	0xb8,0xc0,0x05,0x33,0xc9,0xbb,0x40,0x00,
	0x9a,0x14,0x00,0xfb,0xff,0x1f,0x0f,0x82,
	0xc9,0x00,0xe8,0xb6,0x13,0xb8,0x50,0x00,
	0x8e,0xe0,0x64,0xa1,0x00,0x00,0x2e,0xa3,
	0x49,0x02,0xb8,0xff,0xff,0xbb,0x08,0x00,
	0xb9,0x80,0x02,0xbf,0x00,0x00,0xba,0x00,
	0x00,0x2e,0xff,0x2e,0x47,0x02,0x1e,0x52,
	0xb8,0x40,0x00,0x8e,0xd8,0x8e,0xe0,0x33,
	0xff,0xb8,0xc0,0x05,0x33,0xc9,0xbb,0x01,
	0x00,0x9a,0x14,0x00,0xfb,0xff,0x5a,0x1f,
	0x0f,0x82,0x1a,0x00,0x64,0x66,0x81,0x3e,
	0x00,0x00,0x46,0x42,0x49,0x4f,0x0f,0x85,
	0x0c,0x00,0x64,0x80,0x3e,0x04,0x00,0x53,
	0x0f,0x85,0x02,0x00,0xf8,0xc3,0xf9,0xc3,
	0x53,0xbb,0x00,0x80,0xe8,0xe8,0x14,0x5b,
	0xea,0xfd,0x00,0x00,0x80,0x0e,0x1f,0x80,
	0xe7,0x07,0x88,0x3e,0xfd,0x0e,0xbf,0x01,
	0x05,0xbe,0x8b,0x0f,0xe8,0xad,0x11,0xb8,
	0x40,0x00,0x8e,0xe0,0x2e,0x66,0x8b,0x16,
	0x20,0x00,0xe8,0x7c,0x00,0x0f,0x83,0x22,
	0x00,0x66,0xba,0x08,0x00,0x00,0x00,0xe8,
	0x6f,0x00,0x0f,0x83,0x15,0x00,0x66,0x83,
	0xc2,0x01,0x66,0x83,0xfa,0x50,0x75,0xef,
	0xbf,0x01,0x0a,0xbe,0x9f,0x0f,0xe8,0x7b,
	0x11,0xeb,0xfe,0xbe,0x07,0x0f,0xc6,0x44,
	0x08,0x40,0x66,0xbf,0x00,0x04,0x00,0x00,
	0x8a,0x0e,0xfd,0x0e,0xe8,0xf4,0x00,0x0f,
	0x83,0x0b,0x00,0xbf,0x01,0x0a,0xbe,0xb0,
	0x0f,0xe8,0x58,0x11,0xeb,0xfe,0xe8,0x3a,
	0x14,0x0f,0x83,0x0b,0x00,0xbf,0x01,0x0a,
	0xbe,0xc6,0x0f,0xe8,0x46,0x11,0xeb,0xfe,
	0x83,0xc6,0x07,0x64,0xc6,0x04,0x9a,0x64,
	0xc7,0x44,0x01,0xe5,0x01,0x64,0x8c,0x4c,
	0x03,0xb8,0x50,0x00,0x8e,0xe0,0x64,0xa1,
	0x00,0x00,0x2e,0xa3,0x49,0x02,0xe9,0xf9,
	0xfe,0x66,0x50,0x66,0x51,0x66,0x52,0xbe,
	0x07,0x0f,0x66,0xbf,0x00,0x04,0x00,0x00,
	0x88,0x74,0x04,0x88,0x54,0x05,0x66,0xc1,
	0xca,0x10,0x88,0x74,0x02,0x88,0x54,0x03,
	0x66,0xc1,0xca,0x10,0x8a,0x0e,0xfd,0x0e,
	0xe8,0x88,0x00,0x66,0x5a,0x66,0x59,0x66,
	0x58,0x64,0x66,0x81,0x3e,0x00,0x00,0x46,
	0x42,0x49,0x4f,0x0f,0x85,0x0c,0x00,0x64,
	0x80,0x3e,0x04,0x00,0x53,0x0f,0x85,0x02,
	0x00,0xf8,0xc3,0xf9,0xc3,0xcd,0x21,0x05,
	0x10,0x00,0x9c,0x1e,0x06,0x60,0x0e,0x1f,
	0xfc,0xbf,0x28,0x00,0xbe,0x22,0x0f,0xe8,
	0xc2,0x10,0xe8,0x8a,0x13,0xe8,0x13,0x11,
	0xbb,0x46,0x18,0xc1,0xeb,0x04,0xb4,0x48,
	0xcd,0x21,0x0f,0x83,0x0b,0x00,0xbf,0x28,
	0x05,0xbe,0x4e,0x0f,0xe8,0xa5,0x10,0xeb,
	0x25,0x48,0x8e,0xc0,0x40,0x26,0xa3,0x01,
	0x00,0x2e,0xa3,0x45,0x02,0x8b,0xd8,0xe8,
	0xb5,0x13,0x2e,0xa0,0xfd,0x0e,0x2e,0xff,
	0x1e,0x43,0x02,0x0e,0x1f,0xbf,0x28,0x05,
	0xbe,0x36,0x0f,0xe8,0x7e,0x10,0x61,0x07,
	0x1f,0x9d,0xcb,0xfa,0x05,0x00,0x00,0x00,
	0x00,0x00,0x00,0x9c,0xe8,0x69,0x01,0x0f,
	0x84,0xa1,0x00,0x51,0xb9,0x10,0x27,0xe6,
	0x6c,0xe2,0xfc,0x59,0xfa,0x2e,0xc6,0x06,
	0xbf,0x03,0x00,0xe8,0x93,0x00,0x0f,0x82,
	0x8a,0x00,0xe8,0xa9,0x00,0xe8,0xb3,0x00,
	0x0f,0x82,0x80,0x00,0xe8,0xbe,0x00,0xe8,
	0xcd,0x00,0x72,0x78,0xba,0x32,0x0c,0xec,
	0xba,0x32,0x0c,0xec,0xa8,0x08,0x74,0x5c,
	0xa8,0x80,0x74,0xf0,0x24,0x70,0x74,0x47,
	0x3c,0x10,0x74,0x29,0x3c,0x40,0x74,0x32,
	0x3c,0x50,0x74,0x0f,0x3c,0x70,0x75,0xdc,
	0x2e,0x80,0x0e,0xbf,0x03,0x04,0xbb,0xc1,
	0x03,0xeb,0x09,0x2e,0x80,0x0e,0xbf,0x03,
	0x08,0xbb,0xc0,0x03,0xba,0x30,0x0c,0xec,
	0x2e,0x88,0x07,0xeb,0xbf,0x2e,0x80,0x0e,
	0xbf,0x03,0x01,0xac,0xba,0x30,0x0c,0xee,
	0xeb,0xb2,0x2e,0x80,0x0e,0xbf,0x03,0x02,
	0xb0,0x44,0xe8,0x79,0x00,0xeb,0xa5,0x2e,
	0x80,0x0e,0xbf,0x03,0x02,0xb0,0x48,0xe8,
	0x6c,0x00,0xeb,0x98,0x2e,0x8a,0x26,0xc0,
	0x03,0x2e,0xa0,0xc1,0x03,0x22,0xe4,0x75,
	0x05,0x9d,0xf8,0xc3,0xb4,0x80,0x9d,0xf9,
	0xc3,0xe8,0xbc,0x00,0x0f,0x85,0x02,0x00,
	0xf9,0xc3,0x51,0xf8,0xb9,0x30,0x75,0xba,
	0x32,0x0c,0xec,0x24,0x08,0x74,0x05,0xe6,
	0x6c,0xe2,0xf4,0xf9,0x59,0xc3,0xb0,0x03,
	0xe6,0xa0,0xb0,0x01,0xe6,0xa1,0xb0,0x20,
	0xe6,0xa8,0xc3,0xba,0x30,0x0c,0xb0,0x01,
	0xd2,0xe0,0x0c,0x80,0xee,0xba,0x32,0x0c,
	0xb0,0x86,0xee,0xf8,0xc3,0xf8,0xb9,0x30,
	0x75,0xba,0x32,0x0c,0xec,0x24,0x08,0x75,
	0x05,0xe6,0x6c,0xe2,0xf4,0xf9,0xc3,0xba,
	0x32,0x0c,0xb0,0x82,0xee,0xc3,0xe6,0xaa,
	0xe4,0xab,0xe4,0xab,0x66,0x8b,0xc7,0xe7,
	0xa4,0x66,0xc1,0xe8,0x10,0xe6,0xa6,0x8a,
	0xc4,0xe6,0xa7,0xb8,0xff,0xff,0x2b,0xc7,
	0xe7,0xa2,0xe4,0xaf,0x24,0x0d,0xe6,0xaf,
	0xe4,0xab,0x24,0x02,0x75,0x0a,0xba,0x32,
	0x0c,0xec,0x34,0x08,0xa8,0x38,0x74,0xf0,
	0xe4,0xab,0xe4,0xaf,0x24,0x0f,0x0c,0x02,
	0xe6,0xaf,0xbf,0x00,0x00,0x66,0x81,0xc7,
	0x00,0x00,0x01,0x00,0xba,0x32,0x0c,0xec,
	0x34,0x08,0xa8,0x38,0x74,0xb6,0x32,0xc0,
	0xe6,0xa7,0xc3,0x66,0x81,0xe2,0xff,0xff,
	0x00,0x00,0x66,0x25,0xff,0xff,0x00,0x00,
	0x66,0xc1,0xe2,0x04,0x66,0x03,0xd0,0xc3,
	0x50,0xe4,0x31,0x3c,0x4a,0x58,0xc3,0x00,
	0x00,0x00,0x41,0x58,0x3d,0x00,0x20,0x42,
	0x58,0x3d,0x00,0x20,0x43,0x58,0x3d,0x00,
	0x20,0x44,0x58,0x3d,0x00,0x20,0x53,0x49,
	0x3d,0x00,0x20,0x44,0x49,0x3d,0x00,0x20,
	0x43,0x53,0x3d,0x00,0x20,0x44,0x53,0x3d,
	0x00,0x20,0x45,0x53,0x3d,0x00,0x00,0x60,
	0x06,0x1e,0x0e,0x57,0x56,0x52,0x51,0x53,
	0x50,0xbf,0xc2,0x03,0x58,0x57,0xe8,0x68,
	0x00,0xe8,0x28,0x00,0x5f,0x47,0x2e,0x80,
	0x3d,0x00,0x75,0xf9,0x47,0x2e,0x80,0x3d,
	0x00,0x75,0xe9,0xb0,0x24,0xe8,0x69,0x00,
	0x61,0xc3,0x51,0x50,0xe8,0x6d,0x00,0x86,
	0xc4,0xe8,0x5d,0x00,0x86,0xc4,0xe8,0x58,
	0x00,0x58,0x59,0xc3,0x86,0xc4,0xe8,0xe9,
	0xff,0x86,0xc4,0xe8,0xe4,0xff,0xc3,0x51,
	0x50,0x55,0x8b,0xec,0x8a,0x46,0x03,0xe8,
	0xd8,0xff,0xb0,0x20,0xe8,0x3a,0x00,0x8a,
	0x46,0x05,0xe8,0xcd,0xff,0x8a,0x46,0x04,
	0xe8,0xc7,0xff,0xb0,0x20,0xe8,0x29,0x00,
	0x5d,0x58,0x59,0xc3,0x50,0xb0,0x0d,0xe8,
	0x1f,0x00,0xb0,0x0a,0xe8,0x1a,0x00,0x58,
	0xc3,0x52,0x51,0x50,0x2e,0x8a,0x15,0x80,
	0xfa,0x00,0x0f,0x84,0x07,0x00,0xb4,0x06,
	0xcd,0x21,0x47,0xeb,0xef,0x58,0x59,0x5a,
	0xc3,0x50,0x52,0x8a,0xd0,0xb4,0x06,0xcd,
	0x21,0x5a,0x58,0xc3,0x8a,0xe0,0x24,0x0f,
	0xd0,0xec,0xd0,0xec,0xd0,0xec,0xd0,0xec,
	0x04,0x30,0x3c,0x39,0x0f,0x8e,0x02,0x00,
	0x04,0x07,0x80,0xc4,0x30,0x80,0xfc,0x39,
	0x0f,0x8e,0x03,0x00,0x80,0xc4,0x07,0xc3,
	0x50,0x52,0xb0,0x76,0xe6,0x56,0xb0,0x02,
	0xe6,0x52,0xb0,0x00,0xe6,0x52,0xba,0x02,
	0x0a,0x32,0xc0,0xe8,0x37,0x00,0xee,0xe8,
	0x33,0x00,0xee,0xe8,0x2f,0x00,0xee,0xe8,
	0x2b,0x00,0xb0,0x40,0xee,0xe8,0x25,0x00,
	0xb0,0x4e,0xee,0xe8,0x1f,0x00,0xb0,0xb7,
	0xee,0xe8,0x19,0x00,0xba,0x08,0x0a,0xb0,
	0x20,0xee,0xe8,0x03,0x00,0x5a,0x58,0xc3,
	0x50,0x52,0xba,0x02,0x0a,0xec,0x24,0x03,
	0x74,0xf8,0x5a,0x58,0xc3,0x51,0xb9,0x00,
	0x01,0x49,0x75,0xfd,0x59,0xc3,0x52,0xe8,
	0xe6,0xff,0xba,0x00,0x0a,0xee,0x5a,0xc3,
	0x60,0x06,0x1e,0x0e,0x57,0x56,0x52,0x51,
	0x53,0x50,0xbf,0xc2,0x03,0x58,0x57,0xe8,
	0x68,0x00,0xe8,0x28,0x00,0x5f,0x47,0x2e,
	0x80,0x3d,0x00,0x75,0xf9,0x47,0x2e,0x80,
	0x3d,0x00,0x75,0xe9,0xb0,0x24,0xe8,0xcd,
	0xff,0x61,0xc3,0x51,0x50,0xe8,0x4c,0xff,
	0x86,0xc4,0xe8,0xc1,0xff,0x86,0xc4,0xe8,
	0xbc,0xff,0x58,0x59,0xc3,0x86,0xc4,0xe8,
	0xe9,0xff,0x86,0xc4,0xe8,0xe4,0xff,0xc3,
	0x51,0x50,0x55,0x8b,0xec,0x8a,0x46,0x03,
	0xe8,0xd8,0xff,0xb0,0x20,0xe8,0x9e,0xff,
	0x8a,0x46,0x05,0xe8,0xcd,0xff,0x8a,0x46,
	0x04,0xe8,0xc7,0xff,0xb0,0x20,0xe8,0x8d,
	0xff,0x5d,0x58,0x59,0xc3,0x50,0xb0,0x0d,
	0xe8,0x83,0xff,0xb0,0x0a,0xe8,0x7e,0xff,
	0x58,0xc3,0x52,0x51,0x50,0x2e,0x8a,0x05,
	0x3c,0x00,0x0f,0x84,0x06,0x00,0xe8,0x6d,
	0xff,0x47,0xeb,0xf1,0x58,0x59,0x5a,0xc3,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x1e,0x57,0x50,0x0e,0x1f,
	0x2e,0xc6,0x06,0xa0,0x05,0x00,0x2e,0xc6,
	0x06,0xa1,0x05,0x01,0x2e,0xc7,0x06,0xa2,
	0x05,0x00,0x00,0x2e,0xc7,0x06,0xa3,0x05,
	0xf3,0x05,0x2e,0x8c,0x0e,0xa5,0x05,0x2e,
	0xc7,0x06,0xa7,0x05,0x00,0x00,0x2e,0xc7,
	0x06,0xa9,0x05,0x01,0x00,0x9c,0xfb,0xbf,
	0xa1,0x05,0xb4,0x00,0xcd,0x97,0x2e,0x80,
	0x3e,0xa0,0x05,0x00,0x74,0xf8,0x9d,0x58,
	0x5f,0x1f,0xc3,0x2e,0xc6,0x06,0xa0,0x05,
	0xff,0xcb,0x9c,0x1e,0x66,0x50,0xfa,0x2e,
	0xa2,0xfd,0x0e,0x33,0xc0,0x8e,0xd8,0x66,
	0xa1,0x4c,0x02,0x2e,0x66,0xa3,0x3e,0x06,
	0x8c,0xc8,0x66,0xc1,0xc0,0x10,0xb8,0x42,
	0x06,0x66,0xa3,0x4c,0x02,0x66,0x58,0x1f,
	0x9d,0xcb,0x06,0xb8,0x93,0x35,0xcd,0x21,
	0x2e,0x89,0x1e,0x3e,0x06,0x2e,0x8c,0x06,
	0x40,0x06,0x0e,0x07,0xba,0x42,0x06,0xb8,
	0x93,0x25,0xcd,0x21,0x07,0xc3,0x00,0x00,
	0x00,0x00,0x3d,0xc0,0x71,0x0f,0x84,0xee,
	0x00,0x3d,0xc0,0x72,0x0f,0x84,0xf8,0x00,
	0x3d,0xc0,0x73,0x74,0x09,0x3c,0xc0,0x74,
	0x10,0x2e,0xff,0x2e,0x3e,0x06,0x2e,0xa0,
	0xfd,0x0e,0xbb,0x11,0x77,0xb9,0x09,0x68,
	0xcf,0x2e,0xf6,0x06,0xfe,0x0e,0x02,0x74,
	0x03,0xe8,0x3c,0xfe,0x06,0x1e,0x2e,0xf6,
	0x06,0xfe,0x0e,0x01,0x74,0x08,0x60,0xe8,
	0x6d,0xfd,0xe8,0xd7,0xfd,0x61,0x2e,0xf6,
	0x06,0xfe,0x0e,0x02,0x74,0x08,0x60,0xe8,
	0x7e,0xfe,0xe8,0xe8,0xfe,0x61,0x2e,0xc6,
	0x06,0x02,0x0f,0x3a,0x1f,0x07,0x2e,0xf6,
	0x06,0xfd,0x0e,0xf8,0x74,0x05,0x2e,0xff,
	0x2e,0x3e,0x06,0x2e,0x88,0x26,0xff,0x0e,
	0xe8,0xfd,0x00,0x2e,0xf6,0x06,0xfe,0x0e,
	0x02,0x0f,0x84,0x36,0x00,0x60,0x50,0x57,
	0x51,0x2e,0x80,0x3e,0xff,0x0e,0x50,0x75,
	0x03,0xe8,0x28,0x00,0x2e,0x80,0x3e,0xff,
	0x0e,0x54,0x75,0x03,0xe8,0x2c,0x00,0x59,
	0x5f,0xb0,0x52,0xe8,0x28,0xfe,0x2e,0xa0,
	0x02,0x0f,0xe8,0x21,0xfe,0x58,0xe8,0x6f,
	0xfe,0xe8,0x91,0xfe,0xe8,0x40,0x00,0xe8,
	0xfe,0xfd,0x61,0xcf,0xb9,0x06,0x00,0x8a,
	0x05,0xe8,0x3f,0xfe,0x47,0xe2,0xf8,0xe8,
	0x7b,0xfe,0xc3,0x80,0xfc,0x00,0x0f,0x85,
	0x24,0x00,0x8a,0x4d,0x02,0x2a,0x4d,0x01,
	0x80,0xc1,0x04,0x32,0xed,0x8a,0x05,0xe8,
	0x21,0xfe,0x8a,0x45,0x01,0xe8,0x1b,0xfe,
	0x8a,0x45,0x02,0xe8,0x15,0xfe,0xe8,0x54,
	0xfe,0x8d,0x7d,0x03,0xe2,0xe7,0xc3,0x51,
	0xb9,0xff,0xff,0xe2,0xfe,0x59,0xc3,0xe8,
	0x22,0x00,0x0e,0x1f,0xb8,0xc0,0x50,0xb9,
	0x01,0x00,0xbf,0x8d,0x07,0xe9,0xfa,0xfe,
	0xe8,0x11,0x00,0xe8,0x1e,0x00,0x0e,0x1f,
	0xb8,0xc0,0x50,0xb9,0x01,0x00,0xbf,0x8d,
	0x07,0xe9,0xe6,0xfe,0x2e,0x89,0x1e,0x8d,
	0x07,0x2e,0x89,0x0e,0x8f,0x07,0x2e,0x89,
	0x16,0x91,0x07,0xc3,0x51,0xbf,0x8d,0x07,
	0xb1,0x06,0x2e,0x8a,0x05,0x8a,0xe8,0xc0,
	0xe8,0x04,0xb4,0x0a,0xf6,0xe4,0x80,0xe5,
	0x0f,0x02,0xc5,0x2e,0x88,0x05,0x47,0x32,
	0xed,0xe2,0xe7,0x59,0xc3,0x00,0x00,0x00,
	0x00,0x00,0x00,0x53,0x8a,0xd8,0x80,0xe3,
	0x0f,0xc0,0xe8,0x04,0xb4,0x0a,0xf6,0xe4,
	0x02,0xc3,0x5b,0xc3,0x00,0x00,0x00,0x00,
	0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,
	0x06,0x1e,0x57,0x56,0x55,0x52,0x51,0x53,
	0x50,0xf8,0x9c,0xfc,0x8b,0xec,0x0e,0x1f,
	0x0e,0x07,0x80,0xfc,0x05,0x77,0x0c,0x0f,
	0xb6,0xfc,0x03,0xff,0x2e,0xff,0x95,0x42,
	0x08,0xeb,0x59,0x80,0xfc,0x50,0x72,0x14,
	0x80,0xfc,0x58,0x77,0x0f,0x0f,0xb6,0xfc,
	0x83,0xef,0x50,0x03,0xff,0x2e,0xff,0x95,
	0x4e,0x08,0xeb,0x40,0x80,0xfc,0x0e,0x75,
	0x05,0xe8,0x02,0x01,0xeb,0x36,0x80,0xfc,
	0x0f,0x75,0x05,0xe8,0x33,0x01,0xeb,0x2c,
	0x80,0xfc,0x15,0x75,0x05,0xe8,0x8b,0x01,
	0xeb,0x22,0x80,0xfc,0x14,0x74,0x1b,0x80,
	0xfc,0x60,0x0f,0x84,0x14,0x00,0x80,0xfc,
	0x61,0x74,0x0f,0x80,0xfc,0xfc,0x74,0x0a,
	0xb4,0x80,0x90,0x90,0xb9,0x02,0x00,0x90,
	0xeb,0x02,0x32,0xe4,0x88,0x66,0x03,0x80,
	0xfc,0x80,0x75,0x03,0x89,0x4e,0x06,0x9d,
	0x58,0x5b,0x59,0x5a,0x5d,0x5e,0x5f,0x1f,
	0x07,0xc3,0x77,0x08,0x8c,0x08,0x9f,0x08,
	0x95,0x08,0x89,0x08,0xc8,0x08,0xb1,0x09,
	0x25,0x0a,0x36,0x0a,0x5d,0x0a,0xcc,0x0a,
	0x60,0x0b,0x8e,0x0b,0xc4,0x0b,0xdf,0x0b,
	0xe8,0x88,0x05,0x9c,0x80,0xfc,0x80,0x90,
	0x75,0x0b,0x81,0xf9,0x80,0x00,0x75,0x05,
	0xc6,0x06,0xa4,0x07,0x01,0x9d,0xc3,0x80,
	0xfa,0x04,0x74,0x09,0xb4,0x80,0x90,0x90,
	0xba,0x02,0x00,0x90,0xc3,0x88,0x16,0xa9,
	0x07,0x32,0xe4,0xc3,0x8a,0x16,0xa9,0x07,
	0x88,0x56,0x08,0xeb,0xf4,0xa0,0xfd,0x0e,
	0xe8,0xca,0x05,0xe8,0xc2,0xff,0xc3,0xb1,
	0xaa,0xa0,0xfd,0x0e,0xe8,0x1f,0x06,0xe8,
	0xb6,0xff,0x72,0x1b,0x0f,0xb6,0x16,0x1c,
	0x0f,0xa1,0x1d,0x0f,0x86,0xe0,0xe8,0xec,
	0x03,0x89,0x56,0x04,0x89,0x46,0x08,0xa0,
	0xa9,0x07,0x88,0x46,0x02,0x32,0xe4,0xc3,
	0x8b,0x7e,0x0e,0x80,0xfd,0xff,0x0f,0x84,
	0x39,0x03,0x80,0xfd,0x00,0x74,0x09,0xb4,
	0x80,0x90,0x90,0xb9,0x02,0x00,0x90,0xc3,
	0x06,0x8e,0x46,0x10,0xa0,0xfd,0x0e,0xe8,
	0x5c,0x05,0xe8,0x73,0xff,0x73,0x05,0xc7,
	0x46,0x04,0x00,0x00,0x07,0xc3,0xa0,0xfd,
	0x0e,0xe8,0x74,0x05,0xe8,0xec,0x04,0x80,
	0xfc,0x80,0x90,0x74,0x1a,0x80,0xfc,0x00,
	0x75,0x26,0x80,0x3e,0xa4,0x07,0x00,0x74,
	0x1f,0xc6,0x06,0xa4,0x07,0x00,0xb4,0x80,
	0x90,0x90,0xb9,0x80,0x00,0x90,0xc3,0x81,
	0xf9,0x80,0x00,0x74,0x06,0x81,0xf9,0x01,
	0x00,0x75,0x05,0xc6,0x06,0xa4,0x07,0x00,
	0xc3,0x32,0xe4,0x80,0xf9,0x05,0x75,0x0a,
	0x32,0xd2,0x86,0x16,0xa7,0x07,0x88,0x56,
	0x08,0xc3,0x80,0xf9,0x00,0x75,0x08,0x8a,
	0x16,0xa4,0x07,0x88,0x56,0x08,0xc3,0x80,
	0xf9,0x01,0x75,0x09,0x88,0x16,0xa4,0x07,
	0x08,0x16,0xa6,0x07,0xc3,0x80,0xf9,0x02,
	0x75,0x0a,0x32,0xd2,0x86,0x16,0xa5,0x07,
	0x88,0x56,0x08,0xc3,0x80,0xf9,0x04,0x75,
	0x05,0x08,0x16,0xa6,0x07,0xc3,0x80,0xf9,
	0x08,0x75,0x08,0x8a,0x16,0xa8,0x07,0x88,
	0x56,0x08,0xc3,0x80,0xf9,0x10,0x75,0x05,
	0x88,0x16,0xa8,0x07,0xc3,0xb4,0x80,0xb9,
	0x02,0x00,0xc3,0x80,0xfd,0xff,0x0f,0x84,
	0x71,0x02,0x50,0x8b,0xc2,0x0f,0xb6,0xd1,
	0xe8,0x02,0x03,0x2d,0x96,0x00,0x83,0xda,
	0x00,0x8a,0xca,0x8b,0xd0,0x58,0xe9,0x17,
	0xff,0x80,0xfd,0x00,0x74,0x12,0x80,0xfd,
	0xfe,0x73,0x0d,0xb4,0x80,0xb9,0x02,0x00,
	0x2e,0xc6,0x06,0x02,0x0f,0x61,0x90,0xc3,
	0x8e,0x46,0x10,0x8b,0x7e,0x0e,0x26,0x8b,
	0x0d,0x2e,0x89,0x0e,0xaa,0x07,0x26,0x8b,
	0x4d,0x02,0x2e,0x89,0x0e,0xac,0x07,0x26,
	0x8b,0x4d,0x04,0x2e,0x89,0x0e,0xae,0x07,
	0xa0,0xfd,0x0e,0xe8,0x90,0x04,0xe8,0x6f,
	0xfe,0x73,0x08,0x2e,0xc6,0x06,0x02,0x0f,
	0x62,0x90,0xc3,0xa0,0x14,0x0f,0x3c,0x11,
	0x75,0x0a,0xb4,0x10,0x2e,0xc6,0x06,0x02,
	0x0f,0x63,0x90,0xc3,0xe8,0x63,0x02,0x0e,
	0x07,0xbf,0xaa,0x07,0xa0,0xfd,0x0e,0xe8,
	0x82,0x04,0xe8,0x43,0xfe,0x2e,0xc6,0x06,
	0x02,0x0f,0x64,0x90,0xc3,0x8e,0x46,0x10,
	0x8b,0x7e,0x0e,0x0e,0x1f,0xbe,0xaa,0x07,
	0x66,0xa5,0xa5,0x32,0xe4,0xc3,0x80,0xfd,
	0xff,0x0f,0x84,0x4c,0xfe,0xa0,0xfd,0x0e,
	0xe8,0x3b,0x04,0xe8,0x1a,0xfe,0x72,0x14,
	0x80,0x3e,0x14,0x0f,0x11,0x0f,0x85,0x38,
	0xfe,0xa0,0xfd,0x0e,0xe8,0x64,0x04,0xe8,
	0x06,0xfe,0x72,0x00,0xc3,0x80,0xfd,0x00,
	0x74,0x09,0xb4,0x80,0x90,0x90,0xb9,0x02,
	0x00,0x90,0xc3,0xa0,0xfd,0x0e,0xe8,0x0d,
	0x04,0xe8,0xec,0xfd,0x72,0x55,0x8e,0x46,
	0x10,0x8b,0x7e,0x0e,0x32,0xe4,0x80,0x3e,
	0x14,0x0f,0x11,0x74,0x08,0x33,0xc0,0x33,
	0xc9,0x88,0x46,0x02,0xc3,0xb0,0x01,0xa2,
	0xa8,0x07,0x26,0xc6,0x05,0x00,0x8a,0x2e,
	0x19,0x0f,0x26,0x88,0x6d,0x01,0x26,0xc6,
	0x45,0x02,0x00,0x8b,0x0e,0x20,0x0f,0x26,
	0x89,0x4d,0x03,0x0f,0xb6,0x0e,0x22,0x0f,
	0x26,0x89,0x4d,0x05,0x8b,0x0e,0x1c,0x0f,
	0x26,0x89,0x4d,0x07,0x8a,0x0e,0x1e,0x0f,
	0x26,0x88,0x4d,0x09,0x32,0xe4,0x33,0xc9,
	0x88,0x46,0x02,0xc3,0xa0,0xfd,0x0e,0xe8,
	0xac,0x03,0xe8,0x8b,0xfd,0x73,0x01,0xc3,
	0xa0,0x14,0x0f,0x3c,0x11,0x75,0x05,0xb4,
	0x10,0x90,0x90,0xc3,0xb1,0xaa,0xa0,0xfd,
	0x0e,0xe8,0xda,0x03,0xe8,0x71,0xfd,0x73,
	0x01,0xc3,0x8a,0x0e,0x15,0x0f,0x8a,0x2e,
	0x16,0x0f,0x8e,0x46,0x10,0x8b,0x76,0x0e,
	0x26,0xc6,0x04,0x00,0x26,0x89,0x4c,0x01,
	0x8a,0x16,0x1c,0x0f,0xa1,0x1d,0x0f,0x26,
	0x88,0x54,0x03,0x26,0x89,0x44,0x04,0x8d,
	0x7c,0x06,0x26,0x8a,0x54,0x01,0x57,0x52,
	0x8a,0xca,0xa0,0xfd,0x0e,0xe8,0x9e,0x03,
	0xe8,0x35,0xfd,0x73,0x03,0x5a,0x5f,0xc3,
	0x5a,0x5f,0xb4,0x01,0xa0,0x18,0x0f,0x3c,
	0x14,0x75,0x07,0xb4,0x02,0x80,0x0e,0x1c,
	0x0f,0x80,0x26,0x08,0x24,0xa0,0x1c,0x0f,
	0x26,0x88,0x05,0xa1,0x1d,0x0f,0x26,0x89,
	0x45,0x01,0x8d,0x7d,0x03,0xfe,0xc2,0x26,
	0x3a,0x54,0x02,0x76,0xc1,0x32,0xe4,0xc3,
	0xa0,0xfd,0x0e,0xe8,0x18,0x03,0xe8,0xf7,
	0xfc,0x73,0x01,0xc3,0xa0,0x14,0x0f,0x3c,
	0x12,0x75,0x05,0xb4,0x22,0x90,0x90,0xc3,
	0x3c,0x11,0x74,0x03,0x32,0xe4,0xc3,0xc6,
	0x06,0xa8,0x07,0x01,0xa0,0xfd,0x0e,0xe8,
	0x58,0x03,0xe8,0xd3,0xfc,0xc3,0xa0,0xfd,
	0x0e,0xe8,0xea,0x02,0xe8,0xc9,0xfc,0x73,
	0x01,0xc3,0x8a,0x26,0x14,0x0f,0x80,0xfc,
	0x11,0x75,0x05,0xb4,0x10,0x90,0x90,0xc3,
	0x80,0xfc,0x12,0x74,0x05,0xb4,0x23,0x90,
	0x90,0xc3,0xc6,0x06,0xa8,0x07,0x00,0xe8,
	0xb8,0x00,0xa0,0xfd,0x0e,0xe8,0x2d,0x03,
	0xe8,0x9d,0xfc,0xc3,0x06,0x8e,0x46,0x10,
	0x8b,0x7e,0x0e,0x26,0x8a,0x45,0x01,0x2e,
	0xa2,0x00,0x0f,0x26,0x8a,0x45,0x03,0x2e,
	0xa2,0x01,0x0f,0x07,0xb4,0x00,0xc3,0x06,
	0x8e,0x46,0x10,0x8b,0x7e,0x0e,0x26,0xc6,
	0x05,0x00,0x2e,0xa2,0x00,0x0f,0x26,0x8a,
	0x45,0x01,0x26,0xc6,0x45,0x02,0x01,0x2e,
	0xa2,0x01,0x0f,0x26,0x8a,0x45,0x03,0x66,
	0xc7,0x45,0x04,0x02,0x00,0x03,0x00,0x07,
	0xb4,0x00,0xc3,0x66,0x51,0x66,0x57,0x87,
	0xf7,0x66,0xc1,0xe7,0x10,0x8b,0xfe,0x80,
	0xfc,0x15,0x75,0x11,0x8b,0xc2,0x8a,0xd1,
	0xe8,0x82,0x00,0x2d,0x96,0x00,0x83,0xda,
	0x00,0x8b,0xca,0x8b,0xd0,0x1e,0x0e,0x1f,
	0xbe,0x68,0x0c,0x88,0x4c,0x03,0x88,0x74,
	0x04,0x88,0x54,0x05,0x88,0x7c,0x07,0x88,
	0x5c,0x08,0x2e,0x8a,0x0e,0xfd,0x0e,0xe8,
	0x01,0xf6,0x1f,0x72,0x0c,0xc7,0x46,0x04,
	0x00,0x00,0xb4,0x00,0x66,0x5f,0x66,0x59,
	0xc3,0xb4,0x80,0xc7,0x46,0x06,0x20,0x00,
	0x66,0x5f,0x66,0x59,0x8b,0x4e,0x06,0xc3,
	0x28,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x52,0x50,0xba,0xe1,0x04,0xb0,
	0x04,0xee,0xfe,0xca,0xb0,0x3f,0xee,0xfe,
	0xc2,0xb0,0x05,0xee,0xfe,0xca,0xb0,0x3f,
	0xee,0x58,0x5a,0xc3,0x51,0xb9,0x94,0x11,
	0xf7,0xf1,0x32,0xe4,0x50,0x8b,0xc2,0x33,
	0xd2,0xb9,0x4b,0x00,0xf7,0xf1,0x8a,0xe0,
	0x8a,0xc2,0x5a,0x59,0xc3,0x51,0x53,0x32,
	0xf6,0x52,0x8a,0xc8,0x32,0xed,0x8a,0xc4,
	0x32,0xe4,0xbb,0x4b,0x00,0xf7,0xe3,0x03,
	0xc8,0x5a,0xb8,0x94,0x11,0xf7,0xe2,0x03,
	0xc1,0x83,0xd2,0x00,0x5b,0x59,0xc3,0x9c,
	0xfa,0xb0,0x07,0x50,0xbf,0x09,0x0d,0xe8,
	0x97,0xf7,0xe8,0x45,0xf7,0xe8,0x5b,0x01,
	0xbf,0x1a,0x0d,0xe8,0x8b,0xf7,0xa0,0x13,
	0x0f,0xe8,0x36,0xf7,0xe8,0x75,0xf7,0x58,
	0x80,0xfd,0x00,0x0f,0x85,0x12,0x00,0x80,
	0x3e,0x13,0x0f,0x05,0x0f,0x84,0x0f,0x00,
	0x80,0x3e,0x13,0x0f,0x04,0x0f,0x84,0x06,
	0x00,0xfe,0xc8,0x3c,0xff,0x75,0xc4,0x9d,
	0xc3,0x54,0x45,0x53,0x54,0x49,0x4e,0x47,
	0x20,0x53,0x43,0x53,0x49,0x2d,0x49,0x44,
	0x3a,0x00,0x20,0x20,0x54,0x59,0x50,0x45,
	0x3a,0x00,0x00,0xc7,0x06,0x03,0x0f,0x13,
	0x0f,0x8c,0x0e,0x05,0x0f,0x66,0xc7,0x06,
	0x07,0x0f,0x00,0x00,0x00,0x00,0x66,0xc7,
	0x06,0x0b,0x0f,0x00,0x00,0x00,0x00,0x66,
	0xc7,0x06,0x0f,0x0f,0x00,0x00,0x00,0x00,
	0xa2,0x07,0x0f,0xc3,0x89,0x3e,0x03,0x0f,
	0x8c,0x06,0x05,0x0f,0x2e,0xa2,0x22,0x0d,
	0xe8,0x32,0x00,0x80,0xfd,0x02,0x0f,0x85,
	0x07,0x00,0x80,0xfc,0x00,0x0f,0x84,0x0e,
	0x00,0x80,0xfd,0x00,0x0f,0x85,0x1c,0x00,
	0x80,0xfc,0x00,0x0f,0x84,0x15,0x00,0x51,
	0x50,0xb0,0x03,0xe8,0xa5,0xff,0xb0,0x11,
	0xa2,0x0b,0x0f,0x2e,0xa0,0x22,0x0d,0xe8,
	0x03,0x00,0x59,0x58,0xc3,0x55,0x8b,0xec,
	0x50,0x53,0x66,0x51,0x52,0x56,0x66,0x57,
	0x1e,0x66,0x0f,0xb7,0x0e,0x03,0x0f,0x66,
	0x0f,0xb7,0x3e,0x05,0x0f,0x66,0xc1,0xe7,
	0x04,0x66,0x03,0xf9,0x8a,0xc8,0x80,0xe1,
	0x07,0xbe,0x07,0x0f,0x0e,0x1f,0xe8,0x92,
	0xf4,0x8b,0xc8,0x80,0xe4,0xfd,0x0f,0x84,
	0x02,0x00,0xb4,0x80,0x89,0x4e,0xf8,0x88,
	0x66,0xff,0x1f,0x66,0x5f,0x5e,0x5a,0x66,
	0x59,0x5b,0x58,0x5d,0xc3,0x06,0x50,0x51,
	0x57,0x0e,0x07,0xbf,0x13,0x0f,0xb0,0x00,
	0xb9,0x24,0x09,0x90,0xf3,0xaa,0x5f,0x59,
	0x58,0x07,0xc3,0x80,0xfd,0x02,0x75,0x07,
	0x80,0xfc,0x00,0x0f,0x84,0x18,0x00,0x80,
	0xfd,0x00,0x74,0x07,0xb4,0x80,0xb9,0x04,
	0x00,0xf9,0xc3,0xf6,0xc4,0x07,0x75,0x07,
	0xb4,0x00,0xb9,0x00,0x00,0xf8,0xc3,0xb4,
	0x80,0xa0,0x15,0x0f,0x24,0x0f,0xb9,0x01,
	0x00,0x3c,0x06,0x0f,0x87,0x0b,0x00,0x53,
	0x0f,0xb6,0xd8,0x2e,0x0f,0xb6,0x8f,0x2c,
	0x0e,0x5b,0xf9,0xc3,0x01,0x01,0x01,0x10,
	0x20,0x02,0x80,0x50,0xe8,0x9e,0xff,0xb0,
	0x12,0xe8,0xe7,0xfe,0xb0,0x08,0xa2,0x0b,
	0x0f,0x58,0xe8,0x48,0xff,0xc3,0x50,0xb0,
	0x28,0xe8,0xd7,0xfe,0x88,0x0e,0x0a,0x0f,
	0x88,0x36,0x0b,0x0f,0x88,0x16,0x0c,0x0f,
	0x88,0x3e,0x0e,0x0f,0x88,0x1e,0x0f,0x0f,
	0x58,0xe8,0xe8,0xfe,0xc3,0x50,0xb0,0x2b,
	0xe8,0xb8,0xfe,0x58,0xe8,0xe5,0xfe,0xc3,
	0x50,0xe8,0x61,0xff,0xb0,0x00,0xe8,0xaa,
	0xfe,0x58,0xe8,0xd7,0xfe,0xc3,0x50,0xe8,
	0x53,0xff,0xb0,0x42,0xe8,0x9c,0xfe,0xc7,
	0x06,0x08,0x0f,0x02,0x40,0xc6,0x06,0x0a,
	0x0f,0x01,0xc6,0x06,0x0f,0x0f,0x10,0x58,
	0xe8,0xb9,0xfe,0xc3,0x50,0xb0,0x47,0xe8,
	0x81,0xfe,0x26,0x8b,0x05,0xa3,0x0a,0x0f,
	0x26,0x8b,0x45,0x02,0xa3,0x0c,0x0f,0x26,
	0x8b,0x45,0x04,0xa3,0x0e,0x0f,0x58,0xe8,
	0x9a,0xfe,0xc3,0x50,0xb0,0x4b,0xe8,0x62,
	0xfe,0x58,0xe8,0x8f,0xfe,0xc3,0x50,0xe8,
	0x0b,0xff,0xb0,0x43,0xe8,0x54,0xfe,0xc6,
	0x06,0x08,0x0f,0x02,0x88,0x0e,0x0d,0x0f,
	0xc6,0x06,0x0f,0x0f,0x0c,0x58,0xe8,0x73,
	0xfe,0xc3,0x50,0xb0,0x4b,0xe8,0x3b,0xfe,
	0x58,0xe8,0x68,0xfe,0xc3,0x50,0xb0,0x4b,
	0xe8,0x30,0xfe,0xb0,0x01,0xa2,0x0f,0x0f,
	0x58,0xe8,0x58,0xfe,0xc3,0xff,0x00,0x00,
	0xff,0xff,0x20,0x00,0x00,0x00,0x00,0x28,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
	0x00,0x00,0x00,0x00,0x8b,0xd8,0x83,0xc3,
	0x10,0xb4,0x48,0xcd,0x21,0x05,0x10,0x00,
	0x2e,0xa3,0x49,0x4e,0x54,0x45,0x52,0x43,
	0x45,0x50,0x54,0x45,0x44,0x20,0x49,0x4f,
	0x2e,0x53,0x59,0x53,0x2e,0x00,0x49,0x4e,
	0x53,0x54,0x41,0x4c,0x4c,0x45,0x44,0x20,
	0x49,0x4e,0x54,0x20,0x39,0x33,0x48,0x20,
	0x48,0x4f,0x4f,0x4b,0x2e,0x00,0x4d,0x41,
	0x4c,0x4c,0x4f,0x43,0x20,0x46,0x41,0x49,
	0x4c,0x45,0x44,0x2c,0x20,0x43,0x41,0x4e,
	0x4e,0x4f,0x54,0x20,0x49,0x4e,0x53,0x54,
	0x41,0x4c,0x4c,0x20,0x59,0x53,0x53,0x43,
	0x53,0x49,0x43,0x44,0x00,0x42,0x4f,0x4f,
	0x54,0x20,0x46,0x52,0x4f,0x4d,0x20,0x49,
	0x4e,0x54,0x45,0x52,0x4e,0x41,0x4c,0x20,
	0x43,0x44,0x00,0x44,0x49,0x52,0x45,0x43,
	0x54,0x20,0x53,0x43,0x53,0x49,0x20,0x43,
	0x44,0x20,0x42,0x4f,0x4f,0x54,0x00,0x49,
	0x4f,0x2e,0x53,0x59,0x53,0x20,0x4e,0x4f,
	0x54,0x20,0x46,0x4f,0x55,0x4e,0x44,0x00,
	0x46,0x41,0x49,0x4c,0x45,0x44,0x20,0x54,
	0x4f,0x20,0x4c,0x4f,0x41,0x44,0x20,0x49,
	0x4f,0x2e,0x53,0x59,0x53,0x00,0x4a,0x55,
	0x4d,0x50,0x20,0x49,0x4e,0x53,0x54,0x52,
	0x55,0x43,0x54,0x49,0x4f,0x4e,0x20,0x4e,
	0x4f,0x54,0x20,0x46,0x4f,0x55,0x4e,0x44,
	0x00,0x50,0x4c,0x45,0x41,0x53,0x45,0x20,
	0x4a,0x4f,0x49,0x4e,0x20,0x55,0x53,0x20,
	0x41,0x54,0x20,0x44,0x45,0x4d,0x4f,0x53,
	0x50,0x4c,0x41,0x53,0x48,0x20,0x32,0x30,
	0x32,0x32,0x00,0x41,0x4e,0x44,0x20,0x32,
	0x30,0x32,0x33,0x2c,0x20,0x32,0x30,0x32,
	0x34,0x2c,0x20,0x2e,0x2e,0x2e,0x00,0x68,
	0x74,0x74,0x70,0x3a,0x2f,0x2f,0x64,0x65,
	0x6d,0x6f,0x73,0x70,0x6c,0x61,0x73,0x68,
	0x2e,0x6f,0x72,0x67,0x00,0xff,0xff,0xff,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0xfc,0x3f,0xff,0xff,0xff,0xff,0xff,
	0xff,0xfc,0x1f,0xff,0xff,0xff,0xff,0xff,
	0xff,0xfc,0x0f,0xff,0xff,0xff,0xff,0xff,
	0xff,0xfc,0x03,0xff,0xff,0xff,0xff,0xff,
	0xff,0xfc,0x01,0xff,0xff,0xff,0xff,0xff,
	0xff,0xfc,0x00,0x6f,0xff,0xff,0xff,0xff,
	0xff,0xfe,0x00,0x22,0x1f,0xff,0xff,0xff,
	0xff,0xfe,0x00,0x00,0x0f,0xff,0xff,0xff,
	0x0f,0xfe,0x00,0x00,0x0f,0xe1,0xff,0x7e,
	0x00,0xc0,0x00,0x00,0x03,0xe1,0x80,0x30,
	0x00,0x40,0x00,0x00,0x01,0xe0,0x00,0x00,
	0x00,0x00,0x00,0x00,0x01,0xe0,0x00,0x00,
	0x00,0x00,0x00,0x00,0x03,0xe0,0x00,0x00,
	0x00,0x00,0x00,0x00,0x07,0xe0,0x00,0x00,
	0x00,0x00,0x00,0x00,0x7f,0xa0,0x00,0x00,
	0x00,0x00,0x00,0x00,0x7f,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0xff,0x80,0x00,0x00,
	0x00,0x00,0x00,0x00,0xff,0xc0,0x00,0x00,
	0x00,0x00,0x00,0x01,0xff,0xe0,0x00,0x00,
	0x00,0x00,0x00,0x01,0xff,0xf0,0x00,0x00,
	0x00,0x00,0x00,0x01,0xff,0xf8,0x00,0x00,
	0x00,0x00,0x00,0x01,0xff,0xf8,0x00,0x00,
	0x00,0x00,0x00,0x03,0xff,0xfe,0xe0,0x00,
	0x00,0x00,0x00,0x03,0xff,0xff,0xf8,0x00,
	0x00,0x00,0x00,0x03,0xff,0xff,0xfc,0x00,
	0x00,0x00,0x00,0x03,0xff,0xff,0xfe,0x00,
	0x00,0x00,0x00,0x03,0xff,0xff,0xfe,0x00,
	0x03,0xc0,0x00,0x03,0xff,0xff,0xfe,0x00,
	0x07,0xc0,0x18,0x03,0xff,0xff,0xfe,0x00,
	0x07,0xe0,0x3c,0x07,0xff,0xff,0xff,0x00,
	0x07,0xc0,0xfc,0x07,0xff,0xff,0xff,0x00,
	0x0f,0xc1,0xfe,0x07,0xff,0xff,0xff,0x00,
	0x0f,0xe1,0xfe,0x07,0xff,0xff,0xff,0x00,
	0x0f,0xe7,0xfe,0x07,0xff,0xff,0xff,0x00,
	0x0f,0xff,0xfe,0x07,0xff,0xff,0xff,0x00,
	0x0f,0xff,0xff,0x03,0xff,0xff,0xff,0x00,
	0x0f,0xff,0xff,0x03,0xff,0xff,0xfc,0x00,
	0x0f,0xff,0xff,0x03,0xff,0xff,0xfc,0x00,
	0x0e,0x3f,0xff,0x83,0xff,0xff,0xff,0x00,
	0x0e,0x0f,0xff,0x83,0xff,0xff,0xff,0x80,
	0x0e,0x00,0x3f,0x83,0xff,0xff,0xff,0x8e,
	0x1e,0x00,0x0f,0x03,0xff,0xff,0xff,0x8f,
	0x7f,0x00,0x07,0x03,0xff,0xff,0xff,0xbf,
	0xff,0x00,0x06,0x03,0xff,0xff,0xff,0xff,
	0xff,0x00,0x00,0x01,0xff,0xff,0xff,0xff,
	0xff,0x80,0x00,0x01,0xff,0x9b,0x5e,0xd7,
	0x7f,0x80,0x00,0x01,0xff,0x6b,0x5e,0xd6,
	0x7f,0x80,0x00,0x01,0xff,0xe8,0x46,0x15,
	0x7f,0x80,0x00,0xf0,0xff,0xeb,0x5a,0xd5,
	0x7f,0xc0,0x03,0xfc,0xff,0xeb,0x5a,0xd3,
	0x7f,0xc0,0x07,0xfe,0xff,0xec,0xc7,0x37,
	0x7f,0xe0,0x0f,0xff,0xff,0xff,0xff,0xff,
	0xff,0xf0,0x1f,0xff,0xff,0x6c,0xdd,0x9b,
	0x5f,0xf1,0xff,0xff,0xff,0x6b,0x5d,0x6b,
	0x5f,0xf3,0xff,0xff,0xff,0x0b,0x5d,0x68,
	0xdf,0xf7,0xff,0xff,0xff,0x6b,0x55,0x6b,
	0x5f,0xff,0xff,0xff,0xff,0x6b,0x49,0x6b,
	0x5f,0xff,0xff,0xff,0xff,0x9c,0xdd,0x98,
	0xdf,0xff,0xff,0xff,0xff,0xba,0x82,0xff,
	0xb0,0x27,0xee,0xba,0x81,0xff,0xb0,0x0f,
	0xee,0xc3,0x06,0x57,0x50,0x51,0xb0,0x0f,
	0xe8,0x33,0x00,0xb8,0x00,0xc0,0x8e,0xc0,
	0xbf,0x00,0x00,0xb9,0x80,0x3e,0xb8,0x00,
	0x00,0xf3,0xab,0x59,0x58,0x5f,0x07,0xc3,
	0x06,0x57,0x50,0x51,0xb0,0x0f,0xe8,0x15,
	0x00,0xb8,0x00,0xc0,0x8e,0xc0,0xbf,0x00,
	0x19,0xb9,0x00,0x32,0xb8,0x00,0x00,0xf3,
	0xab,0x59,0x58,0x5f,0x07,0xc3,0x24,0x0f,
	0xba,0x81,0xff,0xee,0xc3,0x50,0x51,0x0f,
	0xb6,0xfc,0xb9,0x00,0x05,0x32,0xe4,0xf7,
	0xe1,0x03,0xf8,0x59,0x58,0xc3,0x1e,0xba,
	0x00,0xc0,0x8e,0xda,0xba,0x99,0xff,0xb0,
	0x01,0xee,0xb0,0x08,0xf6,0xe4,0x05,0x00,
	0xa0,0xb9,0x08,0x00,0x8b,0xf0,0x8a,0x34,
	0x88,0x35,0x88,0x75,0x50,0x46,0x81,0xc7,
	0xa0,0x00,0xe2,0xf2,0xba,0x99,0xff,0x32,
	0xc0,0xee,0x1f,0xc3,0x06,0x56,0x57,0x50,
	0x52,0x51,0xb8,0x00,0xc0,0x8e,0xc0,0x8b,
	0xde,0x8b,0xf3,0xac,0x3c,0x00,0x74,0x0e,
	0x8a,0xe0,0xe8,0xb9,0xff,0x81,0xc7,0x01,
	0xfb,0x83,0xc3,0x01,0xeb,0xeb,0x59,0x5a,
	0x58,0x5f,0x5e,0x07,0xc3,0x06,0x50,0x51,
	0xb8,0x00,0xc0,0x8e,0xc0,0x33,0xc0,0xb9,
	0x80,0x02,0xf3,0xab,0x59,0x58,0x07,0xc3,
	0x50,0x56,0xe8,0x80,0xff,0xe8,0xbc,0xff,
	0x5e,0x58,0x80,0x3c,0x00,0x74,0x03,0x46,
	0xeb,0xf8,0x46,0xfe,0xc0,0x80,0x3c,0xff,
	0x75,0xe6,0xc3,0x06,0x57,0xb8,0x00,0xc0,
	0x8e,0xc0,0xbe,0x2d,0x10,0xbf,0x48,0x14,
	0xbb,0x40,0x00,0xb9,0x04,0x00,0xad,0x35,
	0xff,0xff,0xab,0xe2,0xf9,0x83,0xef,0x58,
	0x4b,0x75,0xf0,0x5f,0x07,0xc3,0x52,0x50,
	0xb0,0x00,0xeb,0x04,0x52,0x50,0xb0,0x80,
	0xba,0x04,0x04,0xee,0x58,0x5a,0xc3,0xba,
	0x04,0x04,0xec,0x24,0x80,0x8a,0xe0,0xba,
	0x80,0x04,0xec,0x24,0x03,0x50,0xb0,0x01,
	0xee,0xb2,0x04,0xb0,0x00,0xee,0x58,0xc3,
	0xba,0x80,0x04,0xee,0xb2,0x04,0x8a,0xc4,
	0xee,0xc3,0x33,0xf6,0x51,0x56,0x57,0xf3,
	0xa6,0x5f,0x5e,0x59,0x74,0x10,0x46,0x83,
	0xfe,0x10,0x75,0xf0,0x8c,0xd8,0x40,0x8e,
	0xd8,0x4a,0x75,0xe6,0xeb,0x0a,0x1e,0x06,
	0x1f,0x07,0x8b,0xfe,0x8b,0xf3,0xf3,0xa4,
	0xc3,0xb8,0x40,0x00,0x8e,0xd8,0xba,0x00,
	0x20,0x0e,0x07,0xe8,0xcc,0xff,0xc3,0xba,
	0x8a,0x04,0xec,0xa8,0x06,0x75,0x44,0x60,
	0xbb,0x00,0xc0,0xba,0x8a,0x04,0xec,0xa8,
	0x06,0xeb,0x44,0x60,0xbb,0x00,0xc0,0xba,
	0x8a,0x04,0xec,0x24,0x06,0x0a,0xc0,0x75,
	0x27,0xba,0x8a,0x04,0xec,0x24,0x06,0x0a,
	0xc0,0xeb,0x27,0x60,0x00,0xc0,0x02,0x00,
	0x00,0x00,0x00,0x1f,0x03,0x00,0x00,0x04,
	0x00,0x00,0x00,0x19,0x04,0x8a,0x00,0x0a,
	0x03,0x8a,0x00,0x0a,0x03,0x46,0x00,0x06,
	0x04,0x46,0x00,0x06,0x04,0x00,0x00,0x8a,
	0x00,0x00,0x00,0x50,0x00,0x00,0x00,0x8a,
	0x00,0x00,0x00,0x80,0x00,0x58,0x00,0x01,
	0x00,0x00,0x00,0x1f,0x80,0x02,0x00,0x00,
	0x00,0x92,0x01,0x40,0x00,0x20,0x03,0x00,
	0x00,0x00,0x00,0x5f,0x03,0x00,0x00,0x10,
	0x00,0x00,0x00,0x6f,0x03,0x9c,0x00,0x1c,
	0x03,0x9c,0x00,0x1c,0x03,0x40,0x00,0x60,
	0x03,0x40,0x00,0x60,0x03,0x00,0x00,0x9c,
	0x00,0x00,0x00,0x50,0x00,0x00,0x00,0x9c,
	0x00,0x00,0x00,0x80,0x00,0x4a,0x00,0x01,
	0x00,0x00,0x00,0x1f,0x00,0x03,0x00,0x00,
	0x00,0x50,0x01,0x1e,0x06,0x60,0xb9,0x0c,
	0x00,0xbf,0x9f,0x13,0xbb,0xab,0x13,0xe8,
	0x37,0xff,0xb9,0x0a,0x00,0xbf,0xb7,0x13,
	0xbb,0xc1,0x13,0xe8,0x2b,0xff,0xb9,0x40,
	0x00,0xbf,0x0b,0x14,0xbb,0xcb,0x13,0xe8,
	0x1f,0xff,0x61,0x07,0x1f,0xc3,0x1e,0x06,
	0x60,0xb9,0x0c,0x00,0xbf,0xab,0x13,0xbb,
	0x9f,0x13,0xe8,0x0c,0xff,0x61,0x07,0x1f,
	0xc3,0x56,0x52,0x50,0xba,0x48,0x04,0xb0,
	0x01,0xee,0xba,0x4a,0x04,0xb0,0x29,0xee,
	0xe8,0x0d,0x00,0xba,0x4a,0x04,0xb0,0x09,
	0xee,0xe8,0x04,0x00,0x58,0x5a,0x5e,0xc3,
	0xba,0x90,0xfd,0xbe,0xc0,0x14,0xb4,0x40,
	0x2e,0x8a,0x04,0x46,0xee,0x80,0xc2,0x02,
	0x80,0xe2,0xf7,0xfe,0xcc,0x75,0xf1,0xc3,
	0x00,0x00,0x00,0x00,0x01,0x70,0x00,0x00,
	0x02,0x00,0x70,0x00,0x03,0x70,0x70,0x00,
	0x04,0x00,0x00,0x70,0x05,0x70,0x00,0x70,
	0x06,0x00,0x70,0x70,0x07,0x70,0x70,0x70,
	0x08,0x00,0x00,0x00,0x09,0xf0,0x60,0x60,
	0x0a,0x00,0xf0,0x00,0x0b,0xf0,0xf0,0x00,
	0x0c,0x00,0x00,0xf0,0x0d,0xf0,0x00,0xf0,
	0x0e,0x00,0xf0,0xf0,0x0f,0xf0,0xf0,0xf0,
	0x60,0x00,0xc0,0x02,0x1f,0x03,0x00,0x00,
	0x04,0x00,0x00,0x00,0x19,0x04,0x8a,0x00,
	0x0a,0x03,0x8a,0x00,0x0a,0x03,0x46,0x00,
	0x66,0x03,0x46,0x00,0x66,0x03,0x00,0x00,
	0x8a,0x00,0x00,0x00,0x50,0x00,0x00,0x00,
	0x8a,0x00,0x00,0x00,0x50,0x00,0x58,0x00,
	0x01,0x00,0x00,0x00,0x3f,0x80,0x02,0x00,
	0x00,0x00,0x92,0x01,0x15,0x08,0x00,0x00,
	0xb6,0x04,0xbb,0x00,0x00,0xb9,0x02,0x00,
	0xe8,0x1c,0x00,0xbb,0x04,0x00,0xb9,0x1c,
	0x00,0xe8,0x13,0x00,0xb4,0x00,0xb9,0x04,
	0x00,0x8a,0xc4,0xb2,0x48,0xee,0xfe,0xc4,
	0xac,0xb2,0x4a,0xee,0xe2,0xf3,0xc3,0x8b,
	0xc3,0xb2,0x40,0xee,0xad,0xb2,0x42,0xef,
	0x43,0xe2,0xf4,0xc3,0xba,0x40,0x04,0xef,
	0xb2,0x42,0x8b,0xc3,0xef,0xc3,0xbe,0x00,
	0x15,0x0e,0x1f,0xe8,0xba,0xff,0xc3,0xbf,
	0x28,0x32,0xbe,0xe1,0x0f,0xe8,0x2c,0xfd,
	0xbf,0x28,0x37,0xbe,0x03,0x10,0xe8,0x23,
	0xfd,0xbf,0x28,0x3c,0xbe,0x17,0x10,0xe8,
	0x1a,0xfd,0xc3,0x1e,0x06,0x0f,0xa0,0x1f,
	0x0e,0x07,0xfc,0xbe,0x00,0x00,0xb9,0x0e,
	0x00,0xbf,0x14,0x0f,0x56,0xf3,0xa6,0x5e,
	0x75,0x0a,0x66,0x81,0x7c,0x10,0x8e,0xc0,
	0x33,0xff,0x74,0x14,0x46,0x83,0xfe,0x10,
	0x75,0xe4,0x8c,0xde,0x46,0x8e,0xde,0x81,
	0xfe,0x00,0x40,0x72,0xd6,0xf9,0xeb,0x04,
	0xf8,0x1e,0x0f,0xa1,0x07,0x1f,0xc3,0x06,
	0x1e,0x56,0x57,0x51,0x0e,0x1f,0x8e,0xc3,
	0x33,0xf6,0x33,0xff,0xb9,0xf7,0x15,0xf3,
	0xa4,0x59,0x5f,0x5e,0x1f,0x07,0xc3
};


int main(int ac,char *av[])
{
	if(2!=ac)
	{
		fprintf(stderr,"Usage: Patch source-file.bin/mdf/iso\n");
		fprintf(stderr,"  This program applies patches to Kyukyoku Tiger for FM TOWNS\n");
		fprintf(stderr,"  BIN/MDF/ISO Image, and makes it force to use CD-ROM BIOS to play BGM.\n");
		fprintf(stderr,"  With this it can run from YSSCSICD.SYS or Rescue IPL with BGM.\n");
		return 1;
	}

	int nByte=0,nByteRead=0,nByteWritten=0;
	unsigned char *byteData=NULL;
	FILE *fp;

	fp=fopen(av[1],"r+b");
	if(NULL==fp)
	{
		fprintf(stderr,"Cannot Open Input File!\n");
		return 1;
	}

	unsigned int LBA=0;
	unsigned char buf[2352];
	while(2352==fread(buf,1,2352,fp))
	{
		auto applied=ApplyPatch(2352,buf,sizeof(expSize_from),expSize_from,sizeof(expSize_to),expSize_to)+
                     ApplyPatch(2352,buf,sizeof(fileSize_from),fileSize_from,sizeof(fileSize_to),fileSize_to)+
                     ApplyPatch(2352,buf,sizeof(uncompressor_size_from),uncompressor_size_from,sizeof(uncompressor_size_to),uncompressor_size_to)+
                     ApplyPatch(2352,buf,sizeof(ignore_T_OAK2_error_from),ignore_T_OAK2_error_from,sizeof(ignore_T_OAK2_error_to),ignore_T_OAK2_error_to)+

					ApplyPatchExternal(
					    2352,buf,
					    sizeof(forceCDBIOS_pattern),forceCDBIOS_pattern,
					    sizeof(forceCDBIOS_pattern)-1,
					    sizeof(forceCDBIOS_patch),forceCDBIOS_patch)+

                     0;

		if(0!=applied)
		{
			printf("Applied Patch to LBA=%d\n",LBA);

			auto pos=ftell(fp);
			fseek(fp,pos-2352,SEEK_SET);
			fwrite(buf,1,2352,fp);
			fseek(fp,pos,SEEK_SET); // fwrite apparently only updates the write pointer, or mess up the read pointer.
		}
		++LBA;
	}

	{
		printf("Injecting SCSI/Internal dual boot IPL.\n");

		unsigned int FBIOSLBA=0,FBIOSLEN=0;
		fseek(fp,16,SEEK_SET);
		fread(buf,1,2048,fp);
		FBIOSLBA=*((unsigned int *)(buf+0x20));
		FBIOSLEN=*((unsigned int *)(buf+0x24));
		*((unsigned int *)(BOOTSECT+0x20))=FBIOSLBA;
		*((unsigned int *)(BOOTSECT+0x24))=FBIOSLEN;

		printf("FBIOS location at LBA %d and Sector Count %d\n",FBIOSLBA,FBIOSLEN);

		for(size_t i=0; i<sizeof(BOOTSECT); i+=2048)
		{
			size_t sect=i/2048;
			size_t bytes=sizeof(BOOTSECT)-i;
			if(2048<bytes)
			{
				bytes=2048;
			}

			fseek(fp,sect*2352+16,SEEK_SET);
			fwrite(BOOTSECT+i,1,bytes,fp);
		}
		printf("Injected SCSI/Internal dual boot IPL.\n");
	}

	fclose(fp);

	printf("Patched!\n");
	return 0;
}
